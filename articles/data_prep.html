<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Preparing data for analysis with Spectre • Spectre</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Preparing data for analysis with Spectre">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started">
<li><a class="dropdown-item" href="../articles/install.html">Install Spectre</a></li>
    <li><a class="dropdown-item" href="../articles/basics_guide.html">Basics guide</a></li>
    <li><a class="dropdown-item" href="../articles/data_prep.html">Preparing your data</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows">
<li><h6 class="dropdown-header" data-toc-skip>Core workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/simple_discovery.html">Simple Discovery analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Batch alignment workflows</h6></li>
    <li><a class="external-link dropdown-item" href="https://immunedynamics.io/spectre/cytonorm/">Batch alignment and analysis with CytoNorm</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ImmuneDynamics/Spectre/blob/master/workflows/Spectre%20rPCA/Spectre%20rPCA.R">Batch alignment and analysis with rPCA</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><a class="dropdown-item" href="../articles/data_transformation.html">Data transformation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/discussions">Discussion</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Preparing data for analysis with Spectre</h1>
                        <h4 data-toc-skip class="author">Thomas
Ashhurst, Givanna Putri</h4>
            
            <h4 data-toc-skip class="date">2025-09-19</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/ImmuneDynamics/Spectre/blob/master/vignettes/data_prep.Rmd" class="external-link"><code>vignettes/data_prep.Rmd</code></a></small>
      <div class="d-none name"><code>data_prep.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="exporting-data-from-flowjo">Exporting data from FlowJo<a class="anchor" aria-label="anchor" href="#exporting-data-from-flowjo"></a>
</h3>
<p>This page explains the initial data analysis and preparation steps
for different forms of cytometry data, and how to export data from
FlowJo in preparation for analysis with Spectre. The overall objective
is to export a population of interest (e.g. leukocytes), usually
following the removal of doublets, debris, dead cells, and any
irrelevant cells. </p>
<p><strong>Population of interest (POI) gating</strong></p>
<p>Gate to your ‘population of interest’ (POI). Typically this will be
‘live cells’, or potentially live CD45+ cells (live leukocytes).</p>
<p><img src="images/clipboard-582034683.png"></p>
<p>Select the POI you wish to export, and then click ‘<strong>Select
Equivalent Nodes</strong>’ in the ‘<strong>Edit</strong>’ space.</p>
<p><img src="images/clipboard-3423209639.png"> … this will select each
POI gates in each samples.</p>
<p><img src="images/clipboard-1845509509.png"></p>
<p>Right click on any of the POI populations (as long as all have been
selected) and select ’<strong>Export / Concatenate
Populations’</strong></p>
<p><img src="images/clipboard-1778792973.png"></p>
<p><strong>Exporting data as an FCS or CSV file</strong></p>
<p>Spectre can import data as FCS or CSV files.</p>
<p>Choose a format for export:</p>
<ul>
<li><p>By default we suggest exporting CSV (scale value) files</p></li>
<li><p>You can also export the data as FCS files</p></li>
<li><p>If you wish, you can export the ‘channel values’ as a CSV file
instead. <em>The channel-values are pre-transformed, which removes the
requirement for an arcsinh transformation in R. See <a href="https://immunedynamics.io/spectre/tutorials/data_transformation/data_transformation.html" class="external-link">this
page</a> for more information.</em></p></li>
</ul>
<p><img src="images/clipboard-1354783275.png"></p>
<p>Under ‘<strong>Parameters</strong>’, select ‘<strong>Custom set of
parameters</strong>’, and select the parameters you wish to export. In
this case, select FSC-A and SSC-A, as well as the compensated (Comp-…)
parameters.</p>
<p>Make sure to select the compensated (‘Comp-…’) parameters.</p>
<p><img src="images/clipboard-2991153619.png"></p>
<p>Choose a location for the export.</p>
<p><img src="images/clipboard-1619573742.png"></p>
<p>Result:</p>
<p><img src="images/clipboard-3488255565.png"></p>
</div>
<div class="section level3">
<h3 id="setup-a-sample-metadata-file">Setup a sample metadata file<a class="anchor" aria-label="anchor" href="#setup-a-sample-metadata-file"></a>
</h3>
<p>To make the analysis a little easier, we usually create a file that
contains relevant metadata for each file (e.g. sample name, group name,
batch, etc). This allows us to add that sample information to each cell
(row) in the data.table in R, making it easy to navigate, filter, and
plot the data by any factor (group, batch, etc). If you have cell count
for your files, this can be added here as well.</p>
<p>For most of our workflows, within the folder you are using for your
analysis there will be:</p>
<ul>
<li><p>The R script</p></li>
<li><p>A ‘data’ folder, and</p></li>
<li><p>A ‘metadata’ folder</p></li>
</ul>
<p><img src="images/clipboard-3923624177.png"></p>
<p>Using Microsoft Excel (or similar), create a new file and save it as
a CSV file in the metadata folder</p>
<p><img src="images/clipboard-1336915300.png"></p>
<p>On a <strong>Mac</strong>, select the files, right click and select
‘copy’ (or press CMD + C).</p>
<p><img src="images/clipboard-2647124696.png"></p>
<p>In the ‘sample.details.csv’ file, name the first column ‘Filename’
(A1), then in A2 right click and select ‘paste’ (or press CMD + V). This
will paste the filenames into the CSV file.</p>
<p><img src="images/clipboard-800630277.png"></p>
<p><em><strong>On Windows</strong>: select files, press CTRL + A, then
paste into excel. Use find and replace to remove the full file path (see
<a href="https://www.youtube.com/watch?v=F7SE5h7AUBg" class="external-link">this video</a> for
a demonstration).</em></p>
<p>You can then add as much information relevant to each file that you
like. Sample, Group, and Batch are ‘required’ for most of the Spectre
workflows (they aren’t actually required, but it makes it easier to use
the default scripts). If all you samples are from one batch, just enter
‘1’ or ‘A’ (or some other batch name) into each row under ‘batch’. If
you would like to add other information (time point, infection,
treatment, etc) then feel free to.</p>
<ul>
<li><p>“Sample” is a recommended column, as this can be a more
simplified name for each sample</p></li>
<li><p>“Group” is extremely useful for most analyses</p></li>
<li><p>“Batch” is helpful if you have prepared, stained, or run samples
in multiple batches. If all you samples are from one batch, just enter
‘1’ or ‘A’ (or some other batch name) into each row under
‘batch’. </p></li>
<li><p>“Cells per sample” is a useful column to add <strong>if</strong>
you intend to generate absolute counts of each population per sample
during the generation of summary data, but is not required
otherwise.</p></li>
<li><p>If you would like to add other information (time point,
infection, treatment, etc) then feel free to.</p></li>
</ul>
<p><img src="images/clipboard-2442827709.png"></p>
<p>You are now ready to get started with Spectre. Check out our
workflows on the <a href="https://immunedynamics.github.io/spectre" class="external-link">Spectre Home page</a>.
The <a href="https://immunedynamics.io/spectre/simple-discovery/" class="external-link">Simple
Discovery Workflow</a> is a great place to get started.</p>
<p><br><br></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Ashhurst, Felix Marsh-Wakefield, Givanna Putri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
