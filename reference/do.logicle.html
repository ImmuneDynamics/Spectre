<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Using logicle to transform data — do.logicle • Spectre</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using logicle to transform data — do.logicle"><meta name="description" content="The function transform data using logicle transformation.
It makes use of flowCore's implementation of logicle transformation, and can
either automatically infer the transformation function based on your data,
or calculate it based on what you want by looking at the default or overriden linearisation.width, max.scale.val, full.transform.width, additional.negative.range.
Description of some of the parameter is adapted from flowCore's vignette.
For more information on what logicle transformation does, please read the manuscript in the references section."><meta property="og:description" content="The function transform data using logicle transformation.
It makes use of flowCore's implementation of logicle transformation, and can
either automatically infer the transformation function based on your data,
or calculate it based on what you want by looking at the default or overriden linearisation.width, max.scale.val, full.transform.width, additional.negative.range.
Description of some of the parameter is adapted from flowCore's vignette.
For more information on what logicle transformation does, please read the manuscript in the references section."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/install.html">Install</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows"><li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/basics_guide.html">Basics guide</a></li>
    <li><a class="dropdown-item" href="../articles/data_prep.html">Data preparation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/simple_discovery.html">Simple Discovery</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/data_transformation.html">Data transformation</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using logicle to transform data</h1>
      <small class="dont-index">Source: <a href="https://github.com/ImmuneDynamics/Spectre/blob/master/R/do.logicle.R" class="external-link"><code>R/do.logicle.R</code></a></small>
      <div class="d-none name"><code>do.logicle.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The function transform data using logicle transformation.
It makes use of flowCore's implementation of logicle transformation, and can
either automatically infer the transformation function based on your data,
or calculate it based on what you want by looking at the default or overriden <code>linearisation.width, max.scale.val, full.transform.width, additional.negative.range</code>.
Description of some of the parameter is adapted from flowCore's vignette.
For more information on what logicle transformation does, please read the manuscript in the references section.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">do.logicle</span><span class="op">(</span><span class="va">dat</span>, <span class="va">use.cols</span>, <span class="va">linearisation.width</span>, <span class="va">max.scale.val</span>, </span>
<span><span class="va">full.transform.width</span>, <span class="va">additional.negative.range</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">do.logicle</span><span class="op">(</span><span class="va">dat</span>, <span class="va">use.cols</span>, auto.infer.function <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>linearisation.width <span class="op">=</span> <span class="fl">1.2</span>, max.scale.val <span class="op">=</span> <span class="fl">262144</span>, full.transform.width <span class="op">=</span> <span class="fl">4.5</span>,</span>
<span>additional.negative.range <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>NO DEFAULT. data.table. Input data</p></dd>


<dt id="arg-use-cols">use.cols<a class="anchor" aria-label="anchor" href="#arg-use-cols"></a></dt>
<dd><p>NO DEFAULT. Vector of column names to transform</p></dd>


<dt id="arg-auto-infer-function">auto.infer.function<a class="anchor" aria-label="anchor" href="#arg-auto-infer-function"></a></dt>
<dd><p>Default = TRUE.
Automatically infer the logical transformation function based on your data.
If this is set to FALSE, default or overriden
<code>linearisation.width, max.scale.val, full.transform.width, additional.negative.range</code>
will be used instead to calculate the logical transformation function.</p></dd>


<dt id="arg-linearisation-width">linearisation.width<a class="anchor" aria-label="anchor" href="#arg-linearisation-width"></a></dt>
<dd><p>Default = 1.2. Linearisation width in asymptotic decades.
This must be &gt; 0 and determines the slope of transformation at zero.
We found 1.2 works well for flow data, and 0.5 works well for cytof data.
It can be estimated using equation:
\((m-log10(max.scale.val/|r|))/2\)
where r is the most negative value to included in the display.
See <code>max.scale.val</code> below.</p></dd>


<dt id="arg-max-scale-val">max.scale.val<a class="anchor" aria-label="anchor" href="#arg-max-scale-val"></a></dt>
<dd><p>Default = 262144. Maximum scale data value.
It can be 10,000 for common 4 decade data or 262144 (the default value) for 18 bit data range.
This must be greater than 0</p></dd>


<dt id="arg-full-transform-width">full.transform.width<a class="anchor" aria-label="anchor" href="#arg-full-transform-width"></a></dt>
<dd><p>Default = 4.5. The full width of the transformed values in asymptotic decades
This must be greater than 0</p></dd>


<dt id="arg-additional-negative-range">additional.negative.range<a class="anchor" aria-label="anchor" href="#arg-additional-negative-range"></a></dt>
<dd><p>Default = 0. Additional negative range to be included in
the transformed value in asymptotic decades.
Value greater than 0 will bring the prescribed additional range into the transformed values</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Parks, David R., Mario Roederer, and Wayne A. Moore. "A new “Logicle” display method avoids deceptive effects of logarithmic scaling for low signals and compensated data." Cytometry Part A: The Journal of the International Society for Analytical Cytology 69.6 (2006): 541-551.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ImmuneDynamics/Spectre" class="external-link">Spectre</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">=</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="va"><a href="demo.clustered.html">demo.clustered</a></span><span class="op">[</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">use.cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">do.logicle</span><span class="op">(</span><span class="va">dat</span>, use.cols <span class="op">=</span> <span class="va">use.cols</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: flowCore</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: Biobase</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: BiocGenerics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Loading required package: generics</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘generics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     as.difftime, as.factor, as.ordered, intersect, is.element, setdiff,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     setequal, union</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘BiocGenerics’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following object is masked from ‘package:flowCore’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     normalize</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:stats’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     IQR, mad, sd, var, xtabs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Filter, Find, Map, Position, Reduce, anyDuplicated, aperm, append,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     as.data.frame, basename, cbind, colnames, dirname, do.call,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     duplicated, eval, evalq, get, grep, grepl, is.unsorted, lapply,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     mapply, match, mget, order, paste, pmax, pmax.int, pmin, pmin.int,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     rank, rbind, rownames, sapply, saveRDS, table, tapply, unique,</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     unsplit, which.max, which.min</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Welcome to Bioconductor</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Vignettes contain introductory material; view with</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'browseVignettes()'. To cite Bioconductor, see</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     'citation("Biobase")', and for packages 'citation("pkgname")'.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Automatically estimating the logicle transformation function based on input data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Transforming data</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Converting data back to data.table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              NK11        CD3     CD45       Ly6G    CD11b      B220      CD8a</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;num&gt;      &lt;num&gt;    &lt;num&gt;      &lt;num&gt;    &lt;num&gt;     &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:   42.3719  40.098700  6885.08  -344.7830 14787.30  -40.2399   83.7175</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   42.9586 119.014000  1780.29  -429.6650  5665.73   86.6673   34.7219</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:   59.2366 206.238000 10248.30 -1603.8400 19894.30  427.8310  285.8800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:  364.9480  -0.233878  3740.04  -815.9800  9509.43  182.4200  333.6050</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:  440.2470  40.035200  9191.38    40.5055  5745.82 -211.6940  149.2200</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                                      </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:  910.8890  72.856100 31466.20  -316.5570 28467.80   -7.7972 -271.8040</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:  -10.2642  64.188700 45188.00  -540.5140 22734.00  202.4110 -936.4920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002: -184.2910  -9.445650 11842.60   -97.9383 17237.00  123.4760 -219.9320</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003:  248.3860 229.986000 32288.20  -681.1630 19255.80 -656.0540 -201.5880</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004:  738.9810  95.470300 46185.10 -1004.6000 22957.80 -661.6280   72.3356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Ly6C NK11_logicle CD3_logicle CD45_logicle Ly6G_logicle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;num&gt;        &lt;num&gt;       &lt;num&gt;        &lt;num&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:   958.7000    1.2627599    1.283089     2.992934    0.9701060</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   448.2590    1.2640218    1.548692     2.405522    0.9517178</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:  1008.8300    1.2989559    1.799549     3.165677    0.7053556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:   440.0710    1.8714522    1.140471     2.727902    0.8686807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:    87.4815    1.9776423    1.282866     3.118405    1.0538616</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000: 12023.7000    2.4113824    1.396508     3.652869    0.9762283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:  4188.3300    1.1491585    1.366834     3.810048    0.9277679</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002:  8923.4000    0.7853742    1.107778     3.228472    1.0237366</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003: 10365.7000    1.6782635    1.858508     3.664068    0.8975110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004:  9704.4700    2.2872091    1.472432     3.819526    0.8286947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CD11b_logicle B220_logicle CD8a_logicle Ly6C_logicle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 &lt;num&gt;        &lt;num&gt;        &lt;num&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:      3.085342    1.0562608    1.4136626    1.3349551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:      2.608476    1.2076286    1.3546434    1.0003851</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:      3.224803    1.5880181    1.6510223    1.3600907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:      2.871745    1.3201315    1.7044840    0.9936275</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:      2.615834    0.8547267    1.4919822    0.6637169</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:      3.390039    1.0949967    0.9904270    2.5534904</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:      3.286692    1.3432289    0.3881125    2.0653896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002:      3.157749    1.2511790    1.0502296    2.4179607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003:      3.209600    0.4118100    1.0716537    2.4862494</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004:      3.291217    0.4072407    1.3999754    2.4562570</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Ashhurst, Felix Marsh-Wakefield, Givanna Putri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

