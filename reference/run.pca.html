<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run the PCA algorithm (using stats::prcomp) — run.pca • Spectre</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run the PCA algorithm (using stats::prcomp) — run.pca"><meta name="description" content="Method to run a PCA dimensionality reduction algorithm.
A principal component analysis (PCA) is capable of reducing the number of dimensions (i.e. parameters) with minimal effect on the variation of the given dataset.
This function will run a PCA calculation (extremely fast) and generate plots (takes time).
For individuals (such as samples or patients), a PCA can group them based on their similarities.
A PCA is also capable of ranking variables/parameters (such as markers or cell counts) based on their contribution to the variability across a dataset in an extremely fast manner.
In cytometry, this can be useful to identify marker(s) that can be used to differentiate between subset(s) of cells.
Uses the base R package &quot;stats&quot; for PCA, &quot;factoextra&quot; for PCA and scree plots, &quot;data.table&quot; for saving .csv files, &quot;ggplot2&quot; for saving plots, &quot;gtools&quot; for rearranging data order, 'RColorBrewer' and 'viridis' for colour schemes.
More information on PCA plots can be found here http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/."><meta property="og:description" content="Method to run a PCA dimensionality reduction algorithm.
A principal component analysis (PCA) is capable of reducing the number of dimensions (i.e. parameters) with minimal effect on the variation of the given dataset.
This function will run a PCA calculation (extremely fast) and generate plots (takes time).
For individuals (such as samples or patients), a PCA can group them based on their similarities.
A PCA is also capable of ranking variables/parameters (such as markers or cell counts) based on their contribution to the variability across a dataset in an extremely fast manner.
In cytometry, this can be useful to identify marker(s) that can be used to differentiate between subset(s) of cells.
Uses the base R package &quot;stats&quot; for PCA, &quot;factoextra&quot; for PCA and scree plots, &quot;data.table&quot; for saving .csv files, &quot;ggplot2&quot; for saving plots, &quot;gtools&quot; for rearranging data order, 'RColorBrewer' and 'viridis' for colour schemes.
More information on PCA plots can be found here http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-getting-started" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Getting started</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-getting-started"><li><a class="dropdown-item" href="../articles/install.html">Install Spectre</a></li>
    <li><a class="dropdown-item" href="../articles/basics_guide.html">Basics guide</a></li>
    <li><a class="dropdown-item" href="../articles/data_prep.html">Preparing your data</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows"><li><h6 class="dropdown-header" data-toc-skip>Core workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/simple_discovery.html">Simple Discovery analysis</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Batch alignment workflows</h6></li>
    <li><a class="external-link dropdown-item" href="https://immunedynamics.io/spectre/cytonorm/">Batch alignment and analysis with CytoNorm</a></li>
    <li><a class="external-link dropdown-item" href="https://github.com/ImmuneDynamics/Spectre/blob/master/workflows/Spectre%20rPCA/Spectre%20rPCA.R">Batch alignment and analysis with rPCA</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/data_transformation.html">Data transformation</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/issues">Report an issue</a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/discussions">Discussion &amp; FAQ</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run the PCA algorithm (using stats::prcomp)</h1>
      <small class="dont-index">Source: <a href="https://github.com/ImmuneDynamics/Spectre/blob/master/R/run.pca.R" class="external-link"><code>R/run.pca.R</code></a></small>
      <div class="d-none name"><code>run.pca.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Method to run a PCA dimensionality reduction algorithm.
A principal component analysis (PCA) is capable of reducing the number of dimensions (i.e. parameters) with minimal effect on the variation of the given dataset.
This function will run a PCA calculation (extremely fast) and generate plots (takes time).
For individuals (such as samples or patients), a PCA can group them based on their similarities.
A PCA is also capable of ranking variables/parameters (such as markers or cell counts) based on their contribution to the variability across a dataset in an extremely fast manner.
In cytometry, this can be useful to identify marker(s) that can be used to differentiate between subset(s) of cells.
Uses the base R package "stats" for PCA, "factoextra" for PCA and scree plots, "data.table" for saving .csv files, "ggplot2" for saving plots, "gtools" for rearranging data order, 'RColorBrewer' and 'viridis' for colour schemes.
More information on PCA plots can be found here http://www.sthda.com/english/articles/31-principal-component-methods-in-r-practical-guide/118-principal-component-analysis-in-r-prcomp-vs-princomp/.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run.pca</span><span class="op">(</span><span class="va">dat</span>, <span class="va">use.cols</span>, scale <span class="op">=</span> <span class="cn">TRUE</span>, add.pca.col <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>pca.col.no <span class="op">=</span> <span class="fl">50</span>, pca.lite <span class="op">=</span> <span class="cn">FALSE</span>, scree.plot <span class="op">=</span> <span class="cn">TRUE</span>, comp.no <span class="op">=</span> <span class="fl">2</span>, </span>
<span>variable.contribution <span class="op">=</span> <span class="cn">TRUE</span>, plot.individuals <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>plot.ind.label <span class="op">=</span> <span class="st">"point"</span>, pointsize.ind <span class="op">=</span> <span class="fl">1.5</span>, row.names <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>plot.ind.group <span class="op">=</span> <span class="cn">FALSE</span>, group.ind <span class="op">=</span> <span class="cn">NULL</span>, colour.group <span class="op">=</span> <span class="st">"viridis"</span>, </span>
<span>pointsize.group <span class="op">=</span> <span class="fl">1.5</span>, ellipse.type <span class="op">=</span> <span class="st">"confidence"</span>, </span>
<span>ellipse.level <span class="op">=</span> <span class="fl">0.95</span>, mean.point <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>randomise.order <span class="op">=</span> <span class="cn">TRUE</span>, order.seed <span class="op">=</span> <span class="fl">42</span>, </span>
<span>plot.variables <span class="op">=</span> <span class="cn">TRUE</span>, colour.var <span class="op">=</span> <span class="st">"solid"</span>, </span>
<span>plot.combined <span class="op">=</span> <span class="cn">TRUE</span>, repel <span class="op">=</span> <span class="cn">FALSE</span>, var.numb <span class="op">=</span> <span class="fl">20</span>, path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>NO DEFAULT. data.frame.</p></dd>


<dt id="arg-use-cols">use.cols<a class="anchor" aria-label="anchor" href="#arg-use-cols"></a></dt>
<dd><p>NO DEFAULT. Vector of numbers, reflecting the columns to use for dimensionality reduction (may not want parameters such as "Time" or "Sample").</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>DEFAULT = TRUE. A logical value indicating whether the variables should be scaled to have unit variance before the analysis takes place.</p></dd>


<dt id="arg-add-pca-col">add.pca.col<a class="anchor" aria-label="anchor" href="#arg-add-pca-col"></a></dt>
<dd><p>DEFAULT = FALSE. Option to add PC coordinates to input data.</p></dd>


<dt id="arg-pca-col-no">pca.col.no<a class="anchor" aria-label="anchor" href="#arg-pca-col-no"></a></dt>
<dd><p>DEFULAT = 50. Number of PC to be added to input data.</p></dd>


<dt id="arg-pca-lite">pca.lite<a class="anchor" aria-label="anchor" href="#arg-pca-lite"></a></dt>
<dd><p>DEFAULT = FALSE. Will stop running the function after PCA coordinates have been added to input data (assuming add.pca.col = TRUE).</p></dd>


<dt id="arg-scree-plot">scree.plot<a class="anchor" aria-label="anchor" href="#arg-scree-plot"></a></dt>
<dd><p>DEFAULT = TRUE. Option to create scree plots. Will save generated scree plot. Note this will require the input of an elbow point during run if comp.no = NULL.</p></dd>


<dt id="arg-comp-no">comp.no<a class="anchor" aria-label="anchor" href="#arg-comp-no"></a></dt>
<dd><p>DEFAULT = 2. Select number of components to be saved. If NULL, user will be asked during run to select number based on scree plot.</p></dd>


<dt id="arg-variable-contribution">variable.contribution<a class="anchor" aria-label="anchor" href="#arg-variable-contribution"></a></dt>
<dd><p>DEFAULT = TRUE. Option to create plot showing the contribution of each variable. Horizontal red line represents the average variable contribution if all variables contributed equally. Requires scree.plot = TRUE.</p></dd>


<dt id="arg-plot-individuals">plot.individuals<a class="anchor" aria-label="anchor" href="#arg-plot-individuals"></a></dt>
<dd><p>DEFAULT = TRUE. Option to create PCA plots on individuals (samples/patients).</p></dd>


<dt id="arg-plot-ind-label">plot.ind.label<a class="anchor" aria-label="anchor" href="#arg-plot-ind-label"></a></dt>
<dd><p>DEFAULT = "point". Option to add text to PCA plots on individuals as an extra identifier. Use c("point", "text") to include both text and point.</p></dd>


<dt id="arg-pointsize-ind">pointsize.ind<a class="anchor" aria-label="anchor" href="#arg-pointsize-ind"></a></dt>
<dd><p>DEFAULT = 1.5. Numeric. Size of dots of individuals on PCA plot.</p></dd>


<dt id="arg-row-names">row.names<a class="anchor" aria-label="anchor" href="#arg-row-names"></a></dt>
<dd><p>DEFAULT = NULL. Column (as character) that defines individuals. Will be used to place name on plot.individuals.</p></dd>


<dt id="arg-plot-ind-group">plot.ind.group<a class="anchor" aria-label="anchor" href="#arg-plot-ind-group"></a></dt>
<dd><p>DEFAULT = FALSE. Option to group individuals with ellipses (which by default show the 95 % confidence interval). Must specify column that groups individuals with group.ind.</p></dd>


<dt id="arg-group-ind">group.ind<a class="anchor" aria-label="anchor" href="#arg-group-ind"></a></dt>
<dd><p>DEFAULT = NULL. Column (as character) that defines groups of individuals. Works with plot.ind.group which must be set to TRUE.</p></dd>


<dt id="arg-colour-group">colour.group<a class="anchor" aria-label="anchor" href="#arg-colour-group"></a></dt>
<dd><p>DEFAULT = "viridis". Colour scheme for each group. Options include "jet", "spectral", "viridis", "inferno", "magma".</p></dd>


<dt id="arg-pointsize-group">pointsize.group<a class="anchor" aria-label="anchor" href="#arg-pointsize-group"></a></dt>
<dd><p>DEFAULT = 1.5. Numeric. Size of shapes of group individuals on PCA plot.</p></dd>


<dt id="arg-ellipse-type">ellipse.type<a class="anchor" aria-label="anchor" href="#arg-ellipse-type"></a></dt>
<dd><p>DEFAULT = "confidence". Set type of ellipse. Options include "confidence", "convex", "concentration", "t", "norm", "euclid". See factoextra::fviz for more information.</p></dd>


<dt id="arg-ellipse-level">ellipse.level<a class="anchor" aria-label="anchor" href="#arg-ellipse-level"></a></dt>
<dd><p>DEFAULT = 0.95. Size of ellipses. By default 95 % (0.95).</p></dd>


<dt id="arg-mean-point">mean.point<a class="anchor" aria-label="anchor" href="#arg-mean-point"></a></dt>
<dd><p>DEFAULT = TRUE. Option to plot the mean on PCA plot with different groups.</p></dd>


<dt id="arg-randomise-order">randomise.order<a class="anchor" aria-label="anchor" href="#arg-randomise-order"></a></dt>
<dd><p>DEFAULT = TRUE. Option to randomise plotting order of individuals to control for overlap.</p></dd>


<dt id="arg-order-seed">order.seed<a class="anchor" aria-label="anchor" href="#arg-order-seed"></a></dt>
<dd><p>DEFAULT = 42. Set the seed for randomising plotting order of individuals.</p></dd>


<dt id="arg-plot-variables">plot.variables<a class="anchor" aria-label="anchor" href="#arg-plot-variables"></a></dt>
<dd><p>DEFAULT = TRUE. Option to create PCA plots on variables (markers/cell counts).</p></dd>


<dt id="arg-colour-var">colour.var<a class="anchor" aria-label="anchor" href="#arg-colour-var"></a></dt>
<dd><p>DEFAULT = "solid". Colour scheme for PCA plot with variables. Options include "solid", "jet", "spectral", "viridis", "inferno", "magma", "BuPu". Note some colours are pale and may not appear clearly on plot.</p></dd>


<dt id="arg-plot-combined">plot.combined<a class="anchor" aria-label="anchor" href="#arg-plot-combined"></a></dt>
<dd><p>DEFAULT = TRUE. Option to create a combined PCA plot with both individuals and variables.</p></dd>


<dt id="arg-repel">repel<a class="anchor" aria-label="anchor" href="#arg-repel"></a></dt>
<dd><p>DEFAULT = FALSE. Option to avoid overlapping text in PCA plots. Can greatly increase plot time if there is a large number of samples.</p></dd>


<dt id="arg-var-numb">var.numb<a class="anchor" aria-label="anchor" href="#arg-var-numb"></a></dt>
<dd><p>DEFAULT = 20. Top number of variables to be plotted. Note the greater the number, the longer plots will take.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>DEFAULT = getwd(). The location to save plots. By default, will save to current working directory. Can be overidden.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Felix Marsh-Wakefield, <a href="mailto:felix.marsh-wakefield@sydney.edu.au">felix.marsh-wakefield@sydney.edu.au</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Set directory to save files. By default it will save files at get()</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run PCA on demonstration dataset, adding PC to dataset</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="va"><a href="demo.clustered.html">demo.clustered</a></span></span></span>
<span class="r-in"><span>                        </span></span>
<span class="r-in"><span><span class="co"># Run PCA on demonstration dataset</span></span></span>
<span class="r-in"><span><span class="fu">Spectre</span><span class="fu">::</span><span class="fu">run.pca</span><span class="op">(</span>dat <span class="op">=</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="va"><a href="demo.clustered.html">demo.clustered</a></span>,</span></span>
<span class="r-in"><span>                use.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                repel <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>                <span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring empty aesthetic: `width`.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>`aes_string()` was deprecated in ggplot2 3.0.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use tidy evaluation idioms with `aes()`.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> See also `vignette("ggplot2-in-packages")` for more information.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">factoextra</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/kassambara/factoextra/issues&gt;</span>.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Saving 6.67 x 6.67 in image</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare between groups</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu">Spectre</span><span class="fu">::</span><span class="fu">run.pca</span><span class="op">(</span>dat <span class="op">=</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="va"><a href="demo.clustered.html">demo.clustered</a></span>,</span></span>
<span class="r-in"><span>                 use.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                 comp.no <span class="op">=</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                 plot.ind.label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"point"</span>, <span class="st">"text"</span><span class="op">)</span>, <span class="co">#individual cells will be labelled as numbers</span></span></span>
<span class="r-in"><span>                 plot.ind.group <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 group.ind <span class="op">=</span> <span class="st">"Group"</span>,</span></span>
<span class="r-in"><span>                 mean.point <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                 randomise.order <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>                 <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span>        </span></span>
<span class="r-in"><span><span class="co"># When prompted, type in "5" and click enter to continue function </span></span></span>
<span class="r-in"><span><span class="co"># (this selects the elbow point based off the scree plot)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Possible issues ##</span></span></span>
<span class="r-in"><span><span class="co"># Remove any NA present</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Index: &lt;Sample&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  FileName      NK11        CD3     CD45       Ly6G    CD11b</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    &lt;char&gt;     &lt;num&gt;      &lt;num&gt;    &lt;num&gt;      &lt;num&gt;    &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:   CNS_Mock_01.csv   42.3719  40.098700  6885.08  -344.7830 14787.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   CNS_Mock_01.csv   42.9586 119.014000  1780.29  -429.6650  5665.73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:   CNS_Mock_01.csv   59.2366 206.238000 10248.30 -1603.8400 19894.30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:   CNS_Mock_01.csv  364.9480  -0.233878  3740.04  -815.9800  9509.43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:   CNS_Mock_01.csv  440.2470  40.035200  9191.38    40.5055  5745.82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                                    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000: CNS_WNV_D7_06.csv  910.8890  72.856100 31466.20  -316.5570 28467.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001: CNS_WNV_D7_06.csv  -10.2642  64.188700 45188.00  -540.5140 22734.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002: CNS_WNV_D7_06.csv -184.2910  -9.445650 11842.60   -97.9383 17237.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003: CNS_WNV_D7_06.csv  248.3860 229.986000 32288.20  -681.1630 19255.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004: CNS_WNV_D7_06.csv  738.9810  95.470300 46185.10 -1004.6000 22957.80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              B220      CD8a       Ly6C       CD4  NK11_asinh    CD3_asinh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             &lt;num&gt;     &lt;num&gt;      &lt;num&gt;     &lt;num&gt;       &lt;num&gt;        &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:  -40.2399   83.7175   958.7000  711.0720  0.04235923  0.040087962</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   86.6673   34.7219   448.2590  307.2720  0.04294540  0.118734817</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:  427.8310  285.8800  1008.8300  707.0940  0.05920201  0.204803270</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:  182.4200  333.6050   440.0710  249.7840  0.35729716 -0.000233878</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5: -211.6940  149.2200    87.4815  867.5700  0.42713953  0.040024513</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                                  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:   -7.7972 -271.8040 12023.7000 1103.0500  0.81693878  0.072791800</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:  202.4110 -936.4920  4188.3300  315.9400 -0.01026402  0.064144703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002:  123.4760 -219.9320  8923.4000 -453.4640 -0.18326344 -0.009445510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003: -656.0540 -201.5880 10365.7000   61.6765  0.24590035  0.228005328</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004: -661.6280   72.3356  9704.4700  -31.8532  0.68430866  0.095325863</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         CD45_asinh  Ly6G_asinh CD11b_asinh   B220_asinh  CD8a_asinh Ly6C_asinh</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              &lt;num&gt;       &lt;num&gt;       &lt;num&gt;        &lt;num&gt;       &lt;num&gt;      &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:   2.627736 -0.33829345    3.388057 -0.040229048  0.08362002  0.8518665</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:   1.340828 -0.41743573    2.435282  0.086559169  0.03471493  0.4344615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:   3.022631 -1.25101677    3.684212  0.415750122  0.28212257  0.8876036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:   2.029655 -0.74509796    2.948184  0.181423123  0.32770787  0.4269784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:   2.914359  0.04049443    2.449108 -0.210143906  0.14867171  0.0873703</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:   4.142314 -0.31149515    4.042229 -0.007797121 -0.26856390  3.1817517</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:   4.504101 -0.51715205    3.817492  0.201053740 -0.83574631  2.1394053</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002:   3.166628 -0.09778240    3.541046  0.123164374 -0.21819650  2.8849492</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003:   4.168089 -0.63716643    3.651633 -0.616293228 -0.20024703  3.0339681</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004:   4.525922 -0.88462254    3.827279 -0.620947819  0.07227267  2.9683779</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CD4_asinh     Sample  Group  Batch FlowSOM_cluster</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               &lt;num&gt;     &lt;char&gt; &lt;char&gt; &lt;char&gt;           &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:  0.66171351 01_Mock_01   Mock      A              23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:  0.30263135 01_Mock_01   Mock      A              55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:  0.65846851 01_Mock_01   Mock      A              64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:  0.24725691 01_Mock_01   Mock      A              53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:  0.78456678 01_Mock_01   Mock      A             110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                     </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:  0.95239703  12_WNV_06    WNV      A              72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:  0.31090687  12_WNV_06    WNV      A              46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002: -0.43920651  12_WNV_06    WNV      A             133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003:  0.06163746  12_WNV_06    WNV      A             133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004: -0.03184782  12_WNV_06    WNV      A             103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         FlowSOM_metacluster        Population     UMAP_X    UMAP_Y</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      &lt;fctr&gt;            &lt;char&gt;      &lt;num&gt;     &lt;num&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      1:                   2         Microglia -2.3603757  6.201213</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      2:                   2         Microglia  2.7505242  7.119595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      3:                   2         Microglia -2.9486033  4.012670</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      4:                   2         Microglia  0.6482904  6.481466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      5:                   4          NK cells -2.3941295  6.975885</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     ---                                                           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169000:                   3 Infil Macrophages -2.9640724 -5.058265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169001:                   3 Infil Macrophages -1.2644785 -3.555824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169002:                   3 Infil Macrophages -2.3592682 -2.429467</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169003:                   3 Infil Macrophages -1.9531062 -4.049705</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 169004:                   3 Infil Macrophages -0.7404098 -4.686928</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Remove columns that have zero variance (e.g. if MFI is the same for all </span></span></span>
<span class="r-in"><span><span class="co"># samples for a marker)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="va">dat</span><span class="op">[</span> , <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">.SD</span>, <span class="kw">function</span><span class="op">(</span><span class="va">v</span><span class="op">)</span> <span class="kw">if</span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/duplicated.html" class="external-link">uniqueN</a></span><span class="op">(</span><span class="va">v</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="va">v</span><span class="op">)</span><span class="op">]</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ellipses are only generated in 'plot.ind.group' when there are at least </span></span></span>
<span class="r-in"><span><span class="co"># 2 samples per group ('group.ind')</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Ashhurst, Felix Marsh-Wakefield, Givanna Putri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

