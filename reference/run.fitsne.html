<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Run FIt-SNE, Fourier Transform TSNE. — run.fitsne • Spectre</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Run FIt-SNE, Fourier Transform TSNE. — run.fitsne"><meta name="description" content="Implementation of FIt-SNE is available from https://github.com/KlugerLab/FIt-SNE.
This function uses fftRtsne to run FIt-SNE."><meta property="og:description" content="Implementation of FIt-SNE is available from https://github.com/KlugerLab/FIt-SNE.
This function uses fftRtsne to run FIt-SNE."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Spectre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.3.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/install.html">Install</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-workflows" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Workflows</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-workflows"><li><h6 class="dropdown-header" data-toc-skip>Getting started</h6></li>
    <li><a class="dropdown-item" href="../articles/basics_guide.html">Basics guide</a></li>
    <li><a class="dropdown-item" href="../articles/data_prep.html">Data preparation</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Core workflows</h6></li>
    <li><a class="dropdown-item" href="../articles/simple_discovery.html">Simple Discovery</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/data_transformation.html">Data transformation</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ImmuneDynamics/Spectre/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Run FIt-SNE, Fourier Transform TSNE.</h1>
      <small class="dont-index">Source: <a href="https://github.com/ImmuneDynamics/Spectre/blob/master/R/run.fitsne.R" class="external-link"><code>R/run.fitsne.R</code></a></small>
      <div class="d-none name"><code>run.fitsne.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implementation of FIt-SNE is available from https://github.com/KlugerLab/FIt-SNE.
This function uses <code>fftRtsne</code> to run FIt-SNE.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">run.fitsne</span><span class="op">(</span><span class="va">dat</span>, <span class="va">use.cols</span>, seed <span class="op">=</span> <span class="fl">42</span>, fitsne.x.name <span class="op">=</span> <span class="st">"FItSNE_X"</span>, </span>
<span>fitsne.y.name <span class="op">=</span> <span class="st">"FItSNE_Y"</span>, dims <span class="op">=</span> <span class="fl">2</span>, perplexity <span class="op">=</span> <span class="fl">30</span>, theta <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>max_iter <span class="op">=</span> <span class="fl">750</span>, fft_not_bh <span class="op">=</span> <span class="cn">TRUE</span>, ann_not_vptree <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  stop_early_exag_iter <span class="op">=</span> <span class="fl">250</span>, exaggeration_factor <span class="op">=</span> <span class="fl">12.0</span>, </span>
<span>  no_momentum_during_exag <span class="op">=</span> <span class="cn">FALSE</span>,start_late_exag_iter <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, </span>
<span>  late_exag_coeff <span class="op">=</span> <span class="fl">1.0</span>, mom_switch_iter <span class="op">=</span> <span class="fl">250</span>, momentum <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>  final_momentum <span class="op">=</span> <span class="fl">0.8</span>, learning_rate <span class="op">=</span> <span class="st">'auto'</span>, n_trees <span class="op">=</span> <span class="fl">50</span>, </span>
<span>  search_k <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, nterms <span class="op">=</span> <span class="fl">3</span>, intervals_per_integer <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  min_num_intervals <span class="op">=</span> <span class="fl">50</span>, K <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, sigma <span class="op">=</span> <span class="op">-</span><span class="fl">30</span>, initialization <span class="op">=</span> <span class="st">'pca'</span>,</span>
<span>  max_step_norm <span class="op">=</span> <span class="fl">5</span>, load_affinities <span class="op">=</span> <span class="cn">NULL</span>, fast_tsne_path <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>  nthreads <span class="op">=</span> <span class="fl">0</span>, perplexity_list <span class="op">=</span> <span class="cn">NULL</span>, get_costs <span class="op">=</span> <span class="cn">FALSE</span>,  df <span class="op">=</span> <span class="fl">1.0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dat">dat<a class="anchor" aria-label="anchor" href="#arg-dat"></a></dt>
<dd><p>NO DEFAULT. Input data.table or data.frame.</p></dd>


<dt id="arg-use-cols">use.cols<a class="anchor" aria-label="anchor" href="#arg-use-cols"></a></dt>
<dd><p>NO DEFAULT. Vector of column names or numbers for clustering.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>Default = 42. Seed value for reproducibility.</p></dd>


<dt id="arg-fitsne-x-name">fitsne.x.name<a class="anchor" aria-label="anchor" href="#arg-fitsne-x-name"></a></dt>
<dd><p>Default = "FItSNE_X". Character. Name of FItSNE x-axis.</p></dd>


<dt id="arg-fitsne-y-name">fitsne.y.name<a class="anchor" aria-label="anchor" href="#arg-fitsne-y-name"></a></dt>
<dd><p>Default = "FItSNE_Y". Character. Name of FItSNE y-axis.</p></dd>


<dt id="arg-dims">dims<a class="anchor" aria-label="anchor" href="#arg-dims"></a></dt>
<dd><p>Default = 2. Dimensionality of the embedding (reduced data).</p></dd>


<dt id="arg-perplexity">perplexity<a class="anchor" aria-label="anchor" href="#arg-perplexity"></a></dt>
<dd><p>Default = 30. Perplexity is used to determine the bandwidth of the Gaussian kernel in the input space</p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>Default = 0.5.
For exact t-SNE, set to 0.
If non-zero, then will use either Barnes Hut or FIt-SNE based on nbody_algo.
If Barnes Hut, then this determines the accuracy of BH approximation.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>Default = 750. Number of iterations of t-SNE to run.</p></dd>


<dt id="arg-fft-not-bh">fft_not_bh<a class="anchor" aria-label="anchor" href="#arg-fft-not-bh"></a></dt>
<dd><p>Default = TRUE. If theta is nonzero, this determines whether to use FIt-SNE or Barnes Hut approximation.</p></dd>


<dt id="arg-ann-not-vptree">ann_not_vptree<a class="anchor" aria-label="anchor" href="#arg-ann-not-vptree"></a></dt>
<dd><p>Default = TRUE. Use vp-trees (as in bhtsne) or approximate nearest neighbors (default).
Set to be TRUE for approximate nearest neighbors.</p></dd>


<dt id="arg-stop-early-exag-iter">stop_early_exag_iter<a class="anchor" aria-label="anchor" href="#arg-stop-early-exag-iter"></a></dt>
<dd><p>Default = 250. When to switch off early exaggeration.</p></dd>


<dt id="arg-exaggeration-factor">exaggeration_factor<a class="anchor" aria-label="anchor" href="#arg-exaggeration-factor"></a></dt>
<dd><p>Default = 12. Coefficient for early exaggeration (&gt;1).</p></dd>


<dt id="arg-no-momentum-during-exag">no_momentum_during_exag<a class="anchor" aria-label="anchor" href="#arg-no-momentum-during-exag"></a></dt>
<dd><p>Default = FALSE. Set to 0 to use momentum and other optimization tricks.
Can be set to 1 to do plain, vanilla gradient descent (useful for testing large exaggeration coefficients).</p></dd>


<dt id="arg-start-late-exag-iter">start_late_exag_iter<a class="anchor" aria-label="anchor" href="#arg-start-late-exag-iter"></a></dt>
<dd><p>Default = -1. When to start late exaggeration.
Set to -1 by default to not use late exaggeration.</p></dd>


<dt id="arg-late-exag-coeff">late_exag_coeff<a class="anchor" aria-label="anchor" href="#arg-late-exag-coeff"></a></dt>
<dd><p>Default = 1. Late exaggeration coefficient.
Set to 1 by default to not use late exaggeration.</p></dd>


<dt id="arg-mom-switch-iter">mom_switch_iter<a class="anchor" aria-label="anchor" href="#arg-mom-switch-iter"></a></dt>
<dd><p>Default = 250. Iteration number to switch from momentum to final_momentum.</p></dd>


<dt id="arg-momentum">momentum<a class="anchor" aria-label="anchor" href="#arg-momentum"></a></dt>
<dd><p>Default = 0.5.Initial value of momentum.</p></dd>


<dt id="arg-final-momentum">final_momentum<a class="anchor" aria-label="anchor" href="#arg-final-momentum"></a></dt>
<dd><p>Default = 0.8. Value of momentum to use later in the optimisation.</p></dd>


<dt id="arg-learning-rate">learning_rate<a class="anchor" aria-label="anchor" href="#arg-learning-rate"></a></dt>
<dd><p>Default = 'auto'. Set to desired learning rate or 'auto', which sets
learning rate to N/exaggeration_factor where N is the sample size, or to
200 if N/exaggeration_factor &lt; 200.</p></dd>


<dt id="arg-n-trees">n_trees<a class="anchor" aria-label="anchor" href="#arg-n-trees"></a></dt>
<dd><p>Default = 50. When using Annoy, the number of search trees to use.</p></dd>


<dt id="arg-search-k">search_k<a class="anchor" aria-label="anchor" href="#arg-search-k"></a></dt>
<dd><p>Default = -1. When using Annoy, the number of nodes to inspect during
search. Default is -1 which translate to 3<em>perplexity</em>n_trees (or K*n_trees when using fixed sigma).</p></dd>


<dt id="arg-nterms">nterms<a class="anchor" aria-label="anchor" href="#arg-nterms"></a></dt>
<dd><p>Default = 3. If using FIt-SNE, this is the number of interpolation points
per sub-interval.</p></dd>


<dt id="arg-intervals-per-integer">intervals_per_integer<a class="anchor" aria-label="anchor" href="#arg-intervals-per-integer"></a></dt>
<dd><p>Default = 1. See min_num_intervals.</p></dd>


<dt id="arg-min-num-intervals">min_num_intervals<a class="anchor" aria-label="anchor" href="#arg-min-num-intervals"></a></dt>
<dd><p>Default = 50. Let maxloc = ceil(max(max(X))) and minloc =
floor(min(min(X))). i.e. the points are in a minloc^no_dims by
maxloc^no_dims interval/square. The number of intervals in each dimension
is either min_num_intervals or ceil((maxloc -
minloc)/intervals_per_integer), whichever is larger. min_num_intervals must
be an integer &gt;0, and intervals_per_integer must be &gt;0. Defaults are
min_num_intervals=50 and intervals_per_integer = 1.</p></dd>


<dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Default = -1. Number of nearest neighbours to get when using fixed sigma.</p></dd>


<dt id="arg-sigma">sigma<a class="anchor" aria-label="anchor" href="#arg-sigma"></a></dt>
<dd><p>Default = -30. Fixed sigma value to use when perplexity==-1.</p></dd>


<dt id="arg-initialization">initialization<a class="anchor" aria-label="anchor" href="#arg-initialization"></a></dt>
<dd><p>Default = 'pca'. pca', 'random', or N x no_dims array to intialize the solution.</p></dd>


<dt id="arg-max-step-norm">max_step_norm<a class="anchor" aria-label="anchor" href="#arg-max-step-norm"></a></dt>
<dd><p>Default = 5. Maximum distance that a point is allowed to move on one
iteration. Larger steps are clipped to this value. This prevents possible
instabilities during gradient descent. Set to -1 to switch it off.</p></dd>


<dt id="arg-load-affinities">load_affinities<a class="anchor" aria-label="anchor" href="#arg-load-affinities"></a></dt>
<dd><p>Default = NULL. If 1, input similarities are loaded from a file and
not computed. If 2, input similarities are saved into a file. If 0,
affinities are neither saved nor loaded.</p></dd>


<dt id="arg-fast-tsne-path">fast_tsne_path<a class="anchor" aria-label="anchor" href="#arg-fast-tsne-path"></a></dt>
<dd><p>Default = NULL. Path to FItSNE executable.</p></dd>


<dt id="arg-nthreads">nthreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>Default = 0. Number of threads to use, set to use all available threads by default.</p></dd>


<dt id="arg-perplexity-list">perplexity_list<a class="anchor" aria-label="anchor" href="#arg-perplexity-list"></a></dt>
<dd><p>Default = NULL. If perplexity==0 then perplexity combination will be
used with values taken from perplexity_list.</p></dd>


<dt id="arg-get-costs">get_costs<a class="anchor" aria-label="anchor" href="#arg-get-costs"></a></dt>
<dd><p>Default = FALSE. Logical indicating whether the KL-divergence costs computed
every 50 iterations should be returned.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Default = 1.0. Positive numeric that controls the degree of freedom of
t-distribution. The actual degree of freedom is 2*df-1. The standard t-SNE
choice of 1 degree of freedom corresponds to df=1. Large df approximates
Gaussian kernel. df&lt;1 corresponds to heavier tails, which can often resolve
substructure in the embedding. See Kobak et al. (2019) for details.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Givanna Putri</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">dat</span> <span class="op">&lt;-</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="va"><a href="demo.clustered.html">demo.clustered</a></span></span></span>
<span class="r-in"><span><span class="va">dat.sub</span> <span class="op">&lt;-</span> <span class="fu">Spectre</span><span class="fu">::</span><span class="fu"><a href="do.subsample.html">do.subsample</a></span><span class="op">(</span><span class="va">dat</span>, <span class="fl">30000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">use.cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">[</span><span class="fl">12</span><span class="op">:</span><span class="fl">19</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dat.reduced</span> <span class="op">&lt;-</span> <span class="fu">run.fitsne</span><span class="op">(</span>dat <span class="op">=</span> <span class="va">dat.sub</span>, use.cols <span class="op">=</span> <span class="va">use.cols</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Ashhurst, Felix Marsh-Wakefield, Givanna Putri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

